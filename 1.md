Plan: Zomieks Freelance Marketplace Platform
TL;DR: Build a full-featured freelance marketplace combining Fiverr-style service listings with Freelancer-style project bidding. The platform uses Next.js 15 with Cloudflare Workers for edge performance, D1 for primary storage, R2 for file uploads (portfolios, ID verification), KV for sessions/caching, and Durable Objects for real-time messaging and escrow state. Payment flow uses milestone-based escrow with OZOW (EFT) and PayFast (card), with 3% buyer fee and 8% seller fee. Subscriptions unlock unlimited bids/services and anonymous outsourcing.

Steps
Phase 1: Project Foundation
Initialize Next.js 15 project with App Router, TypeScript, Tailwind CSS, and configure for Cloudflare Workers deployment via @cloudflare/next-on-pages

Set up shadcn/ui component library with custom Zomieks theme (colors, typography, spacing)

Configure Drizzle ORM with D1 adapter, create migration system, and establish schema conventions

Set up Cloudflare services:

D1 database (primary data)
R2 bucket (files: avatars, portfolios, ID documents, service images)
KV namespace (sessions, rate limiting, caching)
Durable Objects (real-time chat, escrow state machines)
Phase 2: Database Schema
Core user tables:

users (id, email, password_hash, name, avatar_url, created_at, verified_at)
user_profiles (user_id, bio, skills[], location, hourly_rate, portfolio_urls[])
user_verification (user_id, id_document_url, status: pending|approved|rejected, reviewed_by, reviewed_at)
user_subscriptions (user_id, plan: free|monthly|annual, starts_at, ends_at, stripe_id)
Marketplace tables:

categories (id, name, slug, parent_id, icon, is_active)
services (id, seller_id, category_id, title, description, pricing_tiers[], images[], delivery_days, is_active)
projects (id, buyer_id, category_id, title, description, budget_min, budget_max, deadline, status, is_outsourced, original_owner_id)
bids (id, project_id, bidder_id, amount, proposal, delivery_days, created_at)
Transaction tables:

orders (id, service_id, buyer_id, seller_id, amount_gross, buyer_fee, seller_fee, amount_net, status)
milestones (id, order_id, title, amount, status: pending|funded|released|disputed, released_at)
escrow_transactions (id, milestone_id, payment_provider, provider_reference, amount, type: deposit|release|refund)
Social tables:

favorites (user_id, favorited_user_id, created_at)
reviews (id, order_id, reviewer_id, reviewee_id, rating, comment, created_at)
messages (id, conversation_id, sender_id, content, read_at, created_at)
conversations (id, participant_ids[], order_id, created_at)
Outsourcing tables:

outsource_requests (id, original_order_id, outsourced_to_user_id, amount, status, is_anonymous: true)
shortlist (user_id, shortlisted_user_id, category_id, notes)
Admin tables:

disputes (id, order_id, raised_by, reason, status, resolution, resolved_by, resolved_at)
admin_users (user_id, role: admin|moderator, permissions[])
audit_logs (id, actor_id, action, entity_type, entity_id, metadata, created_at)
Phase 3: Authentication & Authorization
Build auth system using email/password with Argon2 hashing, session tokens stored in KV with 7-day expiry

Create middleware for route protection (authenticated, verified, subscription-level)

Implement email verification flow via Resend with magic link tokens

Build ID verification upload using R2 presigned URLs, create admin queue for manual review

Create subscription gating logic:

Free: 5 bids, 1 service, no outsourcing
Paid: Unlimited bids/services, outsourcing enabled
Phase 4: Core Marketplace Features
Service listings:

Create/edit service with pricing tiers (Basic/Standard/Premium)
Image upload to R2 with optimization
Category assignment, search, and filtering
Public service detail pages with seller profile
Project posting:

Create project with budget range and deadline
Category assignment and skill tags
Invite users from shortlist to bid
Bidding system:

Submit bids with proposal and timeline
Track remaining free bids for free-tier users
Bid comparison view for project owners
Order flow:

Service purchase or bid acceptance creates order
Define milestones for project-based work
Status progression: pending → in_progress → delivered → completed
Phase 5: Payments & Escrow
Integrate OZOW (Instant EFT) for SA bank payments:

Generate payment requests
Handle webhook callbacks for payment confirmation
Store transaction references
Integrate PayFast (Card payments):

Redirect flow for card payments
ITN (Instant Transaction Notification) webhook handling
Implement milestone escrow via Durable Objects:

Buyer funds milestone → funds held in escrow state
Seller delivers → buyer releases or opens dispute
On release → trigger payout (minus fees)
Fee calculation: gross × 1.03 (buyer pays) → net × 0.92 (seller receives)
Payout system:

Queue payouts for approved milestones
Admin-initiated bank transfers (manual initially, automate later)
Phase 6: Messaging & Notifications
Real-time messaging using Durable Objects:

WebSocket connections per conversation
Message persistence to D1
Typing indicators, read receipts
Notification system:

In-app notifications (stored in D1, delivered via polling/WebSocket)
Email notifications via Resend (new message, order update, bid received, payment)
Phase 7: Outsourcing Feature (Paid Plans)
Outsourcing workflow:

Original order owner can create anonymous outsource request
Request goes to shortlisted users with category match
Outsourced user accepts → new linked order created
Client sees only original seller; outsourced user is hidden
Shortlist management:

Add/remove users to shortlist per category
Quick outsource to available shortlisted users
Phase 8: Reviews & Trust
Review system:

After order completion, both parties can leave reviews
1-5 star rating + text comment
Aggregate rating displayed on profiles
Trust indicators:

Verified badge (ID verified)
Pro badge (subscription + top ratings)
Response time, completion rate metrics
Phase 9: Admin Dashboard
Admin panel routes (protected by admin role):

User management (view, suspend, approve verification)
ID verification queue with approve/reject
Dispute resolution interface
Category management (CRUD)
Platform analytics dashboard
Audit logging for all admin actions

Phase 10: Subscription & Billing
Subscription management:
Plan selection UI (Monthly ~R99 / Annual ~R999)
Payment via PayFast recurring or one-time
Subscription status checks in middleware
Grace period handling for expired subscriptions
Verification
Unit tests: Drizzle queries, fee calculations, subscription logic
Integration tests: Auth flows, payment webhooks, escrow state transitions
E2E tests: Full order lifecycle from service purchase to payout
Manual testing: ID verification queue, dispute resolution, outsourcing anonymity
Load testing: Simulate concurrent bids, messages, payments
Decisions
Cloudflare over Vercel: Edge runtime for SA latency, D1/R2/DO integration, cost efficiency
Durable Objects for escrow: Strongly consistent state machine for financial transactions
Milestone-based escrow: Reduces risk for both parties, industry standard
Manual ID verification: Balances security with implementation complexity (can add AI later)
Anonymous outsourcing: Preserves client trust while enabling scaling for sellers
8% seller + 3% buyer fees: Covers gateway fees (~2.5%) + platform margin
